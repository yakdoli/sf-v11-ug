<html>

<head>
<style type="text/css">
.style1 {
	margin-left: 40px;
}
</style>
</head>

<h1>Export Image</h1>

<p>The Export Image sample demonstrates the exporting capabilities of Essential Diagram.</p>


<p><div align=center><img src="images/sample.png" alt="ExportImage Image" title="" /></div></p>

<p>
<p><strong>Features</strong></p>

<p class="style1"><ul><li> This sample shows the <strong>Diagram.ExportDiagramAsImage</strong> and
<strong>Diagram.ExportDiagramToGraphics</strong> 
methods used to export a diagram document in the following formats.</li></ul></p>

<p><ul><li>Image Format
<p><ul><li>BMP</li></ul>
<ul><li>EXIF</li></ul>
<ul><li>GIF</li></ul>
<ul><li>ICON</li></ul>
<ul><li>JPEG</li></ul>
<ul><li>PNG</li></ul>
<ul><li>TIFF</li></ul></p>
</li></ul>
<ul><li>Metafile</li></ul></p>
<ul>
	<li> To export a diagram as an image, use the following code.</ul>

						<p><font color="#8D2E1C"><pre>
						private void SaveImage(string filename, ImageFormat imageformat )
						{
						  if(imageformat != ImageFormat.Emf)
						  {
						   Image img = this.diagram1.View.ExportDiagramAsImage(true);
						  img.Save(filename,imageformat);
						 }
						 else	// Export diagram to a metafile
						 {
						  this.SaveDiagramAsEmf(filename);
						 }
						</pre></font></p>

						<p><font color="#8D2E1C"><pre>
						/ Create a Metafile with the provided file name and draw the diagram to it.
						private void SaveDiagramAsEmf(string filename)
						{	
						  // Create a Metafile with the provided file name and draw the diagram to it.
						  Image diagramimage = new Bitmap(1, 1, PixelFormat.Format24bppRgb);
						  Graphics grfx = Graphics.FromImage(diagramimage);
						  IntPtr hdc = grfx.GetHdc();
						  Metafile emf = new Metafile(filename, hdc, EmfType.EmfOnly);
						  Graphics emfgrfx = Graphics.FromImage(emf);

						  this.diagram1.ExportDiagramToGraphics(emfgrfx);
						  grfx.ReleaseHdc(hdc);
						  grfx.Dispose();
						  emfgrfx.Dispose();
						  diagramimage.Dispose();
						  emf.Dispose();
						}</pre></font></p></p>

</li></ul>
</html>