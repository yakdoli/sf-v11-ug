<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Win32)">
	<META NAME="CREATED" CONTENT="20090102;5081831">
	<META NAME="CHANGED" CONTENT="20090102;23585818">
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>Print to Fit Demo</H1>
<P>This sample illustrates how to print a grid on a single page. It
derives a <STRONG>GridPrintDocument</STRONG> class 
to handle the printing of the entire grid on a single page. It
does this by drawing the full-size grid to a large bitmap, and then
drawing this bitmap, scaled to fit the output page. 
</P>
<P><BR><BR>
</P>
<P ALIGN=CENTER><img src="images/sample.png" NAME="graphics1" ALT="Print To Fit screenshot" ALIGN=BOTTOM  BORDER=0></P>
<P ALIGN=LEFT STYLE="font-weight: medium"><FONT COLOR="#000000">The following code overrides <strong>OnPrintPage</strong> in the inherited <strong>GridPrintDocument</strong> class.</FONT></P>
<PRE><FONT COLOR="#8d2e1c">            protected override void OnPrintPage(System.Drawing.Printing.PrintPageEventArgs ev)</FONT>
<FONT COLOR="#8d2e1c">            {</FONT>
<FONT COLOR="#8d2e1c">                ev.HasMorePages = false;</FONT>
<FONT COLOR="#8d2e1c">                int gridHeight = _grid.Model.RowHeights.GetTotal(0, _grid.Model.RowCount);</FONT>
<FONT COLOR="#8d2e1c">                int gridWidth = _grid.Model.ColWidths.GetTotal(0, _grid.Model.ColCount);</FONT>
<FONT COLOR="#8d2e1c">                Bitmap gridBM = new Bitmap(gridWidth, gridHeight);</FONT>
<FONT COLOR="#8d2e1c">                Graphics g = Graphics.FromImage(gridBM);</FONT>
<FONT COLOR="#8d2e1c">                Rectangle saveGridRect = this._grid.GridBounds;</FONT>
<FONT COLOR="#8d2e1c">                this._grid.GridBounds = new Rectangle(0, 0, gridWidth, gridHeight);</FONT>
<FONT COLOR="#8d2e1c">                this._grid.DrawGrid(g);</FONT>
<FONT COLOR="#8d2e1c">                this._grid.GridBounds = saveGridRect;</FONT>
<FONT COLOR="#8d2e1c">     </FONT>
<FONT COLOR="#8d2e1c">                g.Dispose();</FONT>
<FONT COLOR="#8d2e1c">                Rectangle destRect = ev.MarginBounds;</FONT>
<FONT COLOR="#8d2e1c">         </FONT>
<FONT COLOR="#8d2e1c">                g = ev.Graphics;</FONT>
<FONT COLOR="#8d2e1c">                System.Drawing.GraphicsUnit gu = System.Drawing.GraphicsUnit.Point;</FONT>
<FONT COLOR="#8d2e1c">                RectangleF srcRect = gridBM.GetBounds(ref gu);</FONT>
<FONT COLOR="#8d2e1c">                g.DrawImage(gridBM,  destRect, srcRect, gu);</FONT>
<FONT COLOR="#8d2e1c">            }  </FONT></PRE>
<P><strong>Features</strong></P>
<UL>
	<LI>
	<P>To print only a single page, set <STRONG>ev.HasMorePages</STRONG> to <EM>false</EM>.</P>
	<LI><P>The bitmap height and width is set to the total height 
	and width of the grid, inorder to draw a full-size bitmap of the grid.</P>
	<LI><P>The image is drawn to an instance of the <strong>Graphics</strong> class	
	by using the<STRONG> DrawImage</STRONG> function.</P>
</UL>
<P ALIGN=LEFT><BR><BR>
</P>
</BODY>
</HTML>