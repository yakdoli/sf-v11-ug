<html><h1>Find-Replace Demo</h1>

<p>This sample implements the find-replace functionality in a grid control. It makes use of the built-in 
<strong>GridFindReplaceDialogSink</strong> and <strong>GridFindReplaceDialogEventArgs</strong> helper classes to construct the custom 
find-replace dialog box. The former class constructs 
a find-replace dialog box sink wherein the options for the find-replace operation are specified through an instance of the latter class. 
<strong>FindReplaceDialogSink</strong>, which has been constructed as mentioned above, will then be associated with the grid control. The 
<strong>GridFindReplaceDialogSink</strong> class provides the methods that are necessary to perform a find-replace operation.</p>
<p><strong>Features</strong></p>

<p><b>Search</b></p>

<p>The options for searching the grid for a given text can be specified in terms of 
the <strong>GridFindTextOptions</strong> enumeration. The possible options available are:
<br><ul>
<li><b>Match Case</b> - Matches case while performing a search<br>
<li><b>Match Whole Cell</b> - Matches the search text with the entire text in a 
grid cell<br>
<li><b>Search Up</b> - Specifies if the search can be performed bottom-up<br>
<ul>
<li><b>Column Only</b> - Searches only the current column<br>
<li><b>Selection Only</b> - Searches only the current selection<br>
<li><b>Whole Table</b> - Searches the whole table</ul></ul></p>

<p><b>Find Next</b><br><br>
This option searches for text, and moves the current cell position 
to the cell that contains the search text. Clicking the <strong>Find Next</strong> button, navigates through the destination cells 
one by one.</p>
<font  color="#8D2E1C"><pre>
	GridFindTextOptions options =  GridFindTextOptions.WholeTable |  GridFindTextOptions.SearchUp;
	object locInfo = GridRangeInfo.Table();
	GridFindReplaceEventArgs frEvents = new GridFindReplaceEventArgs(cmbSearch.Text, "", options, locInfo);
	GridFindReplaceDialogSink frDialog.Find(frEvents);
</pre></font>

<p><b>Find All</b><br><br>
This option loops through all the cells in the grid to search for the given text and highlights the cells that contain the search text.</p>
<font  color="#8D2E1C"><pre>
	GridFindTextOptions options =  GridFindTextOptions.WholeTable |  GridFindTextOptions.SearchUp;
	object locInfo = GridRangeInfo.Table();
	GridRangeInfo selRange = GridRangeInfo.Empty;
                int rowIndex, colIndex;
                if ((options & GridFindTextOptions.SelectionOnly) != GridFindTextOptions.None)
                    selRange = gridControl1.Selections.Ranges.ActiveRange;

                else if ((options & GridFindTextOptions.ColumnOnly) != GridFindTextOptions.None)
                    selRange = GridRangeInfo.Col(gridControl1.CurrentCell.ColIndex);

                else if ((options & GridFindTextOptions.WholeTable) != GridFindTextOptions.None)
                    selRange = GridRangeInfo.Cells(1, 1, gridControl1.RowCount, gridControl1.ColCount);

                int startTop = selRange.Top;
                int startLeft = selRange.Left;

                while (GridFindReplaceDialogSink.GetNextCell(selRange, ref startTop, ref startLeft, false, chkSearchUp.Checked))
                {
                    GridStyleInfo style = gridControl1[startTop, startLeft];
                    GridCellRendererBase renderer = gridControl1.CellRenderers[style.CellType];
                    if (renderer.FindText(cmbSearch.Text, startTop, startLeft, options, true))
                    {
                        gridControl1.CurrentCell.GetCurrentCell(out rowIndex, out colIndex);
                        gridControl1[rowIndex, colIndex].BackColor = Color.Orange;
                    }
                }
</pre></font></p>

<p><b>Replace</b><br><br>
This option replaces text, one at a time.</p>
<font  color="#8D2E1C"><pre>
	GridFindTextOptions options =  GridFindTextOptions.WholeTable |  GridFindTextOptions.SearchUp;
	object locInfo = GridRangeInfo.Table();
	GridFindReplaceEventArgs frEvents = new GridFindReplaceEventArgs(cmbSearch.Text, cmbReplace.Text, options, locInfo);
	GridFindReplaceDialogSink frDialog.Replace(frEvents);
</pre></font>

<p><b>Replace All</b><br><br>
This option replaces text in all the applicable cells at once.</p>
<font  color="#8D2E1C"><pre>
	GridFindTextOptions options =  GridFindTextOptions.WholeTable |  GridFindTextOptions.SearchUp;
	object locInfo = GridRangeInfo.Table();
	GridFindReplaceEventArgs frEvents = new GridFindReplaceEventArgs(cmbSearch.Text, cmbReplace.Text, options, locInfo);
	GridFindReplaceDialogSink frDialog.ReplaceAll(frEvents);
</pre></font>
<br>
<p>The following illustration shows the find-replace options of grid.</p>

<p><div align=center><img src="images/sample.png" alt="GridFindReplace" title="" /></div>

</html>