<html>
<head>
    <style type="text/css">
        .style2
        {
            font-size: medium;
            font-weight: bold;
        }
    </style>
</head>
<h1>Find-Replace Demo</h1>

<p>This sample features support for performing search-and-replace operations with 
    the Grid Grouping Control.</p>
<p><B>Find and Replace</B></p>

<p><div align=center><img src="images/sample.png" alt="FindReplaceSample" title="" /></div>
</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
<p class="style2">Features</p>
<p>&nbsp;It allows you to do the following actions with data records in the grouping 
    grid:</p>

<ul>
<li><b>Find</b> - Finds text with the specified criteria</li>
    <li><b>Find All</b> - Finds text in all the cells with the specified criteria</li>
<li><b>Replace</b> - Replaces text with the specified criteria</li>
<li><b>Replace All</b> - Replaces the text in all the cells with the specified 
criteria</li>
</ul>

<p>It also explores various search options such as whether to ignore case 
or perform search only in a current column or whole table. The <b>GridFindTextOptions</b> defines the possible search options for grid data. </p>

<p>The available search options are listed and explained below.</p>

<ul>
<li><b>Match Case</b> - Indicates whether the search is case sensitive</li>
<li><b>Match Whole Cell</b> - The search succeeds only if the search string 
matches the whole cell</li>
<li><b>Search Up</b> - Indicates whether to perform a bottom-up search</li>
<li><b>Whole Table</b> - Searches the whole table</li>
<li><b>Column Only</b> - Searches only in the current column.</li>
</ul></p>

<p class="style2">Implementation</p>
<p>Below are sample code snippets that implement these operations. The <B>QueryCellStyleInfo</B> 
event is handled to implement the <B>FindAll </B>operation; it highlights all the data records containing the search string.</p>

<p><b>Find</b></p>
<p><font color="#8D2E1C"><pre>
GridFindReplaceEventArgs frEvents = new GridFindReplaceEventArgs(txtSearch.Text, "", searchOptions, locInfo);
GridFindReplaceDialogSink frDialog = new GridFindReplaceDialogSink(gridGroupingControl1.TableControl);
frDialog.Find(frEvents);
</pre></font></p>

<p><b>Replace</b></p>
<p><font color="#8D2E1C"><pre>
GridFindReplaceEventArgs frEvents = new GridFindReplaceEventArgs(txtSearch.Text, txtReplace.Text, searchOptions, locInfo);
GridFindReplaceDialogSink frDialog = new GridFindReplaceDialogSink(gridGroupingControl1.TableControl);
frDialog.Replace(frEvents);
</pre></font></p>

<p><b>Replace All</b></p>
<p><font color="#8D2E1C"><pre>
GridFindReplaceEventArgs frEvents = new GridFindReplaceEventArgs(txtSearch.Text, txtReplace.Text, searchOptions, locInfo);
GridFindReplaceDialogSink frDialog = new GridFindReplaceDialogSink(gridGroupingControl1.TableControl);
frDialog.ReplaceAll(frEvents);
</pre></font></p>

<p><b>Find All by Query Cell Style Info</b></p>
<p><font color="#8D2E1C"><pre>
void  gridGroupingControl1_QueryCellStyleInfo(object sender, GridTableCellStyleInfoEventArgs e)
        {
                DataRowView dr = e.TableCellIdentity.DisplayElement.GetData() as DataRowView;
                GridRangeInfo range = gridGroupingControl1.TableControl.Selections.Ranges.ActiveRange;
                if (cmbOptions.Text.Equals("WholeTable") && dr != null)
                {
                    for (int i = 0; i < gridGroupingControl1.TableModel.ColCount-2; i++)
                        if (dr[i].Equals(txtSearch.Text))
                        {
                            e.Style.BackColor = Color.Orange;
                            break;
                        }
                }  
        }
</pre>
</font></p>
</html>