::: {style="DISPLAY: none"}
[](ms-xhelp:///?Id=d2h_url_template){#d2h_url_template}![](!package_url!){#d2h_package_url style="WIDTH: 0px; DISPLAY: none; HEIGHT: 0px"}
:::

::: {.d2h_secondary_topic style="PADDING-BOTTOM: 10pt; MARGIN: 0pt; PADDING-LEFT: 0pt; PADDING-RIGHT: 0pt; PADDING-TOP: 0pt"}
#### Adding DragAndDropManager to an Application

 

The Namespace that is required for using DragAndDropManager is provided in the following code snippet:

 

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[XAML\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                 |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                                 |
| [xmlns]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[:]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Syncfusion]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"clr-namespace:Syncfusion.Windows.Shared.Controls; ]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"} |
|                                                                                                                                                                                                                                                                                 |
| [                  assembly=Syncfusion.Shared.Silverlight\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

+------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                             |
|                                                                                                                                    |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                             |
|                                                                                                                                    |
| [using]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Syncfusion.Windows.Shared.Controls;]{style="FONT-FAMILY: 'Courier New'"} |
+------------------------------------------------------------------------------------------------------------------------------------+

 

[]{#AllowDrag}Every object that will be dragged must have the AllowDrag property set to True. This is an attached property and in XAML it can be set in the following way:

 

 

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[XAML\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Syncfusion]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[:]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[DragAndDropManager.AllowDrag]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"True\" ]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[x]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[:]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Name]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"listBox1\"\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[]{style="FONT-FAMILY: 'Courier New'; COLOR: red"} |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

[]{#SetAllowDrag}In code-behind the AllowDrag property can be set as:

[]{style="COLOR: black"} 

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                              |
|                                                                                                                                                                     |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                              |
|                                                                                                                                                                     |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.SetAllowDrag(listBox1, [true]{style="COLOR: blue"});]{style="FONT-FAMILY: 'Courier New'"} |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

[]{#AllowDrop}Similarly, the AllowDrop property should be set to True for all the objects that will be the drop targets of the drag and drop operation. In XAML it can be set in the following way:

 

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[XAML\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Syncfusion]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[:]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[DragAndDropManager.AllowDrop]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"True\" ]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[x]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[:]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Name]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"listBox2\"\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[]{style="FONT-FAMILY: 'Courier New'; COLOR: red"} |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[]{style="COLOR: black"} 

[]{#SetAllowDrog}In code behind, the AllowDrop property can set as:

 

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                              |
|                                                                                                                                                                     |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                              |
|                                                                                                                                                                     |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.SetAllowDrop(listBox2, [true]{style="COLOR: blue"});]{style="FONT-FAMILY: 'Courier New'"} |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

After setting the AllowDrag and AllowDrop property for the elements, as seen above, the elements will receive all the DragAndDropManager events.

 

The DragStarted event is the first event that will be fired when dragging an object. This event can be subscribed as follows:

[]{#DragStarted} 

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                          |
|                                                                                                                                                                                                           |
| []{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}                                                                                                                                                    |
|                                                                                                                                                                                                           |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.DragStarted +=]{style="FONT-FAMILY: 'Courier New'"}                                                                             |
|                                                                                                                                                                                                           |
| [                   [new]{style="COLOR: blue"} [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_DragStarted);]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"} |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                     |
|                                                                                                                                                                                                                      |
| []{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}                                                                                                                                                               |
|                                                                                                                                                                                                                      |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_DragStarted([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                      |
| [  {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                            |
|                                                                                                                                                                                                                      |
| [    throw]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                                   |
|                                                                                                                                                                                                                      |
| [    [/\* delete the above statement and to do necessary steps to start ]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                                 |
|                                                                                                                                                                                                                      |
| [      dragging the object \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                                                                    |
|                                                                                                                                                                                                                      |
| [  }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[]{#PayLoad} 

Usually, in this DragStarted event handler, the PayLoad is set to the object that needs to be dragged. The PayLoad is the property of the object of DragAndDropEventArgs. Also, the DragIcon is set to an image that denotes the dragged object.

 

The next event that will be fired after the DragStarted event is Drag. This will be raised continuously along with the MouseMove event during the drag process.  This event can be subscribed as follows:

[]{#Drag} 

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                           |
|                                                                                                                                                                                                                            |
| []{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}                                                                                                                                                                     |
|                                                                                                                                                                                                                            |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.Drag += [new]{style="COLOR: blue"} [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_Drag);]{style="FONT-FAMILY: 'Courier New'"} |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                              |
|                                                                                                                                                                                                               |
| []{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}                                                                                                                                                        |
|                                                                                                                                                                                                               |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_Drag([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                               |
| [  {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                     |
|                                                                                                                                                                                                               |
| [    [throw]{style="COLOR: blue"} [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                                                        |
|                                                                                                                                                                                                               |
| [    [/\* delete the above statement and to do necessary steps on dragging]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                        |
|                                                                                                                                                                                                               |
| [       the object \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                                                                     |
|                                                                                                                                                                                                               |
| [  }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                               |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

Perform the necessary operations during the dragging process using the above event handler.

 

When the dragged object enters the boundary of the target element (the DragAndDropManaer.AllowDrop property of that element is True) the DropEnter event gets fired for that element. []{#DropEnter}This event can be subscribed as follows:

 

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                                                           |
|                                                                                                                                                                                                                                                            |
| []{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}                                                                                                                                                                                                     |
|                                                                                                                                                                                                                                                            |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.DropEnter += [new                              ]{style="COLOR: blue"}]{style="FONT-FAMILY: 'Courier New'"}                                                                       |
|                                                                                                                                                                                                                                                            |
| [                  ]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[DragDropEventHandler]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[(DragAndDropManager_DropEnter);]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"} |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                   |
|                                                                                                                                                                                                                    |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_DropEnter([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                    |
| [ {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                           |
|                                                                                                                                                                                                                    |
| [     throw]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                                |
|                                                                                                                                                                                                                    |
| [     [/\* delete the above statement and to do necessary steps that needed when ]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                      |
|                                                                                                                                                                                                                    |
| [       dragged object entered into boundary of target element \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                              |
|                                                                                                                                                                                                                    |
| [ }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                           |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

For example, the DropEnter event handler is used to set the DropDescription that describes how the object is handled by the target element. The DropDescription is the property of the object of DragAndDropEventArgs.

 

The Drop event gets fired when the dragged object is dropped into the boundary of the target element. This event can be subscribed as follows:

[]{#Drop} 

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **\[C#\]**                                                                                                                                                                                                                                           |
|                                                                                                                                                                                                                                                      |
| []{style="FONT-FAMILY: Consolas; COLOR: #2b91af; FONT-SIZE: 9.5pt"}                                                                                                                                                                                  |
|                                                                                                                                                                                                                                                      |
| [DragAndDropManager]{style="FONT-FAMILY: Consolas; COLOR: #2b91af; FONT-SIZE: 9.5pt"}[.Drop += [new]{style="COLOR: blue"} [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_Drop);]{style="FONT-FAMILY: Consolas; FONT-SIZE: 9.5pt"} |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                              |
|                                                                                                                                                                                                               |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_Drop([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                               |
| [  {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                     |
|                                                                                                                                                                                                               |
| [    throw]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                            |
|                                                                                                                                                                                                               |
| [    [/\* delete the above statement and to do necessary steps that needed when ]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                  |
|                                                                                                                                                                                                               |
| [       drop the object into the boundary of target element \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                            |
|                                                                                                                                                                                                               |
| [  }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

The necessary steps for managing the drag and drop of an object is implemented in the event handler.\
For example, the dragged object is removed from the source element and added into the target element using this event handler.

 

When the dragged object leaves the boundary of the target element without getting dropped then the DropLeave event gets fired for that element. This event can be subscribed as follows:

[]{#DropLeave} 

 

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                   |
|                                                                                                                                                                                    |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.DropLeave += [new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                            |
|                                                                                                                                                                                    |
| [                         [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_DropLeave);]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"} |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                   |
|                                                                                                                                                                                                                    |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_DropLeave([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                    |
| [ {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                           |
|                                                                                                                                                                                                                    |
| [    throw]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                                 |
|                                                                                                                                                                                                                    |
| [    [/\* delete the above statement and to do necessary steps that needed when ]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                       |
|                                                                                                                                                                                                                    |
| [       dragged object leaved from boundary of target element without drop \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                  |
|                                                                                                                                                                                                                    |
| [ }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                     |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

The necessary steps that need to be executed when the dragged object leaves the target element boundary are included in the following event hander.

 

[]{#DragKey}The QueryContinueDrag event gets raised when any key in the keyboard is pressed during dragging process. The pressed key is stored in the DragKey property of the object DragDropEventArgs. This event can be subscribed as follows:

[]{#QueryContinueDrag} 

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**[  ]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}                                                                            |
|                                                                                                                                                                                     |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.QueryContinueDrag += [new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                     |
|                                                                                                                                                                                     |
| [                  [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_QueryContinueDrag);]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"} |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                |
|                                                                                                                                                                                                                       |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_QueryContinueDrag([object]{style="COLOR: blue"} sender,[DragDropEventArgs]{style="COLOR: #2b91af"}  ]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                       |
| [args)]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                           |
|                                                                                                                                                                                                                       |
| [   {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                            |
|                                                                                                                                                                                                                       |
| [     throw]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                                   |
|                                                                                                                                                                                                                       |
| [     [/\* delete the above statement and to do necessary steps that needed when ]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                         |
|                                                                                                                                                                                                                       |
| [        any key in keyboard is pressed \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                                                        |
|                                                                                                                                                                                                                       |
| [   }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

Usually, the DragMode can be changed with this event handler. For example, the DragMode is set to DragMode.Copy when Ctrl (Control) is pressed. The QueryContinueDrag is the most suitable handler for changing the DragMode.

 

[]{#DropCancelled}The DropCancelled event gets fired when dropping an object into the target element gets cancelled.

This event can be subscribed as follows:

 

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                 |
|                                                                                                                                                                                  |
| [DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.DropCancelled += [new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                      |
|                                                                                                                                                                                  |
| [                   [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_DropCancelled);]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"} |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

This will create the following hollow event handler:

 

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                       |
|                                                                                                                                                                                                                        |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_DropCancelled([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                        |
| [  {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                              |
|                                                                                                                                                                                                                        |
| [   [throw]{style="COLOR: blue"} [new]{style="COLOR: blue"} [NotImplementedException]{style="COLOR: #2b91af"}();]{style="FONT-FAMILY: 'Courier New'"}                                                                  |
|                                                                                                                                                                                                                        |
| [   [/\* delete the above statement and to do necessary steps when the ]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                                    |
|                                                                                                                                                                                                                        |
| [       drop operation cancelled \*/]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                                                                |
|                                                                                                                                                                                                                        |
| [  }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

The following ListBoxDragAndDrop example describes the implementation of simple drag and drop between two ListBox controls.

 

1.   Open Visual Studio. 

 

2.   Create a new Silverlight Application project and name it ListBoxDragAndDrop.

 

3.   ListBoxItem is the type of ObjcetModel.  The instance of ObjectModel is used as PayLoad for drag and drop operation.  So create the ObjectModel class as follows.

 

 

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                        |
|                                                                                                                                                                                                                                               |
| [ ]{style="FONT-FAMILY: 'Courier New'"}[public]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ [class]{style="COLOR: blue"} [ObjectModel]{style="COLOR: #2b91af"} ]{style="FONT-FAMILY: 'Courier New'"}                                    |
|                                                                                                                                                                                                                                               |
| [    {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                   |
|                                                                                                                                                                                                                                               |
| [        [public]{style="COLOR: blue"} ObjectModel()]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                     |
|                                                                                                                                                                                                                                               |
| [        {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                               |
|                                                                                                                                                                                                                                               |
| [            SubCollection = [new]{style="COLOR: blue"} [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\>();]{style="FONT-FAMILY: 'Courier New'"}                                                       |
|                                                                                                                                                                                                                                               |
| [        }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                               |
|                                                                                                                                                                                                                                               |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                               |
| [        [public]{style="COLOR: blue"} [string]{style="COLOR: blue"} Name { [get]{style="COLOR: blue"}; [set]{style="COLOR: blue"}; }]{style="FONT-FAMILY: 'Courier New'"}                                                                    |
|                                                                                                                                                                                                                                               |
| [        [public]{style="COLOR: blue"} [ImageSource]{style="COLOR: #2b91af"} Icon { [get]{style="COLOR: blue"}; [set]{style="COLOR: blue"}; }]{style="FONT-FAMILY: 'Courier New'"}                                                            |
|                                                                                                                                                                                                                                               |
| [        [public]{style="COLOR: blue"} [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\> SubCollection { [get]{style="COLOR: blue"}; [set]{style="COLOR: blue"}; }]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                                               |
| []{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                               |
| [     }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                            |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[]{style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 11pt"} 

 

4.   Now create a source **ListBox** in the Silverlight page by using XAML as given in the following code snippet:

[]{style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 11pt"} 

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[XAML\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ [ Syncfusion]{style="COLOR: red"}[:]{style="COLOR: blue"}[DragAndDropManager.AllowDrop]{style="COLOR: red"}[=\"True\"]{style="COLOR: blue"}[ ]{style="COLOR: red"}]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [           ItemsSource]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"{]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Binding]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Path]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=MyProperty}\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Name]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Source\"\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemContainerStyle]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [  ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Style]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ TargetType]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"ListBoxItem\"\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [   ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Setter]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Property]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Syncfusion:DragAndDropManager.AllowDrag\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[      ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [           Value]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"True\"/\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [   ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Style]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemContainerStyle]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemTemplate]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [   ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[DataTemplate]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [     ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Grid]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [       ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Border]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Background]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Transparent\" ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ MouseMove]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Border_MouseMove\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}                                                                                                                                                                                                                                                                                                                                                           |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [               MouseLeave]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Border_MouseLeave\"\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [        ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[StackPanel]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Orientation]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Horizontal\"\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[    ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [         ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Image]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Source]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"{]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Binding]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Icon]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[}\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Width]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"50\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Height]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"50\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"} |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [                 Margin]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"10\"/\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [          ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[TextBlock]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Text]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"{]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Binding]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Name]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[}\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Margin]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"10\"]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}                                                                                                                                                      |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [                     VerticalAlignment]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Center\"/\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [        ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[StackPanel]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [       ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Border]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [      ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[Grid]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [     ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[DataTemplate]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [   ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemTemplate]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [ ]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="LINE-HEIGHT: 150%; FONT-FAMILY: 'Courier New'; COLOR: blue"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

 

 

The list box items for the ListBox control are provided with Data Binding. So, Style is used to set the AllowDrag and AllowDrop properties for each list box items.

 

5.   Create the target **ListBox** similar to the creation of the source **ListBox**. This is shown in the following code snippet.

 

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[XAML\]]{style="FONT-FAMILY: 'Courier New'"}**[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ [ Syncfusion]{style="COLOR: red"}[:]{style="COLOR: blue"}[DragAndDropManager.AllowDrop]{style="COLOR: red"}[=\"True\"]{style="COLOR: blue"}[ ]{style="COLOR: red"}]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [           ItemsSource]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"{]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Binding]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Path]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=MyProperty}\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Name]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Target\"\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [ \<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemContainerStyle]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [  ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Style]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ TargetType]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"ListBoxItem\"\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [   ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Setter]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Property]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Syncfusion:DragAndDropManager.AllowDrag\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[      ]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}                                                                                                                                                                                                                                                                                                                                                                      |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [           Value]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"True\"/\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [  ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Style]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [ ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemContainerStyle]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [ ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemTemplate]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [   ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[DataTemplate]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [     ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Grid]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [      ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Border]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Background]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Transparent\"\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                             |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [       ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[StackPanel]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Orientation]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Horizontal\"\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[    ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}                                                                                                                                                                                                                                                                                                                                                                                    |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [         ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Image]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Source]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"{]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Binding]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Icon]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[}\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Width]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"50\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Height]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"50\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ ]{style="FONT-FAMILY: 'Courier New'; COLOR: red"} |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [                Margin]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"10\"/\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [           ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\<]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[TextBlock]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Text]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"{]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Binding]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[ Name]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[}\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ Margin]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"10\"]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ ]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}                                                                                                               |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [                      VerticalAlignment]{style="FONT-FAMILY: 'Courier New'; COLOR: red"}[=\"Center\"/\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [        ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[StackPanel]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [       ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Border]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [      ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[Grid]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [    ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[DataTemplate]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [ ]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox.ItemTemplate]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [\</]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ListBox]{style="FONT-FAMILY: 'Courier New'; COLOR: #a31515"}[\>]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[]{style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 11pt"} 

The binding sources for the ListBox controls are given in the corresponding code behind file.

 

6.   In the  code behind file, subscribe the DragAndDropManager events as given in the following code snippet

[]{style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 11pt"} 

+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                      |
|                                                                                                                                                       |
| [public]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ MainPage()]{style="FONT-FAMILY: 'Courier New'"}                                            |
|                                                                                                                                                       |
| [ {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                              |
|                                                                                                                                                       |
| [  InitializeComponent();]{style="FONT-FAMILY: 'Courier New'"}                                                                                        |
|                                                                                                                                                       |
| [ [DragAndDropManager]{style="COLOR: #2b91af"}.DragStarted += [new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                        |
|                                                                                                                                                       |
| [          [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_DragStarted);]{style="FONT-FAMILY: 'Courier New'"}                       |
|                                                                                                                                                       |
| [ DragAndDropManager]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[.Drop += [new]{style="COLOR: blue"}   ]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                       |
| [          [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_Drop);]{style="FONT-FAMILY: 'Courier New'"}                              |
|                                                                                                                                                       |
| [ [DragAndDropManager]{style="COLOR: #2b91af"}.Drag += [new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                               |
|                                                                                                                                                       |
| [           [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_Drag);]{style="FONT-FAMILY: 'Courier New'"}                             |
|                                                                                                                                                       |
| [ [DragAndDropManager]{style="COLOR: #2b91af"}.DropLeave += [new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                          |
|                                                                                                                                                       |
| [            [DragDropEventHandler]{style="COLOR: #2b91af"}(DragAndDropManager_DropLeave);]{style="FONT-FAMILY: 'Courier New'"}                       |
|                                                                                                                                                       |
| [   }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------+

 

 

7.   Now, create the objects of **ObjectModel** class and add those objects into the corresponding collection for **ListBoxItem** data source.

 

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                                   |
|                                                                                                                                                                                                                                    |
| [//create the ObjectModel instances for ListBoxItem as follows]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}**[]{style="FONT-FAMILY: 'Courier New'"}**                                                                        |
|                                                                                                                                                                                                                                    |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ MainPage_Loaded([object]{style="COLOR: blue"} sender, [RoutedEventArgs]{style="COLOR: #2b91af"} e)]{style="FONT-FAMILY: 'Courier New'"}                                   |
|                                                                                                                                                                                                                                    |
| [{]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                                            |
|                                                                                                                                                                                                                                    |
| [ MyProperty = [new]{style="COLOR: blue"} [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\>();]{style="FONT-FAMILY: 'Courier New'"}                                                          |
|                                                                                                                                                                                                                                    |
| [ MyProperty1 = [new]{style="COLOR: blue"} [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\>();]{style="FONT-FAMILY: 'Courier New'"}                                                         |
|                                                                                                                                                                                                                                    |
| [ [ObjectModel]{style="COLOR: #2b91af"} item1 = [new]{style="COLOR: blue"} [ObjectModel]{style="COLOR: #2b91af"}() { Name = [\"Recent Places\"]{style="COLOR: #a31515"},                     ]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                                    |
| [       Icon = [new]{style="COLOR: blue"} [BitmapImage]{style="COLOR: #2b91af"}([new]{style="COLOR: blue"}                                    ]{style="FONT-FAMILY: 'Courier New'"}                                                |
|                                                                                                                                                                                                                                    |
| [        [Uri]{style="COLOR: #2b91af"}([\"/ListBoxDragAndDrop;component/Images/recentplaces.png\"]{style="COLOR: #a31515"},  ]{style="FONT-FAMILY: 'Courier New'"}                                                                 |
|                                                                                                                                                                                                                                    |
| [              [UriKind]{style="COLOR: #2b91af"}.RelativeOrAbsolute)) };]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                      |
|                                                                                                                                                                                                                                    |
| [ [ObjectModel]{style="COLOR: #2b91af"} item2 = [new]{style="COLOR: blue"} [ObjectModel]{style="COLOR: #2b91af"}() { Name = [\"Calendar\"]{style="COLOR: #a31515"},]{style="FONT-FAMILY: 'Courier New'"}                           |
|                                                                                                                                                                                                                                    |
| [         Icon = [new]{style="COLOR: blue"} [BitmapImage]{style="COLOR: #2b91af"}([new]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                                                                                 |
|                                                                                                                                                                                                                                    |
| [         [Uri]{style="COLOR: #2b91af"}([\"/ListBoxDragAndDrop;component/Images/calendar.png\"]{style="COLOR: #a31515"},  ]{style="FONT-FAMILY: 'Courier New'"}                                                                    |
|                                                                                                                                                                                                                                    |
| [             [UriKind]{style="COLOR: #2b91af"}.RelativeOrAbsolute)) };]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                       |
|                                                                                                                                                                                                                                    |
| [ MyProperty.Add(item1);]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                      |
|                                                                                                                                                                                                                                    |
| [ MyProperty1.Add(item2);]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                     |
|                                                                                                                                                                                                                                    |
| [}]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

Similarly, create all the list box items for the source and target ListBox controls.

 

8.   The **PayLoad** of the **DragDropEventArgs** needs to be set in **DragStarted** event handler. This is shown in the following code snippet.

 

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                                     |
|                                                                                                                                                                                                                      |
| [ [// DragStarted event implementation]{style="COLOR: green"}]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                   |
|                                                                                                                                                                                                                      |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_DragStarted([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                                      |
| [{]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                              |
|                                                                                                                                                                                                                      |
| [ if]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ (sender [is]{style="COLOR: blue"} [ListBoxItem]{style="COLOR: #2b91af"})]{style="FONT-FAMILY: 'Courier New'"}                                                |
|                                                                                                                                                                                                                      |
| [  {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                            |
|                                                                                                                                                                                                                      |
| [    ObjectModel]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[ obj = (([FrameworkElement]{style="COLOR: #2b91af"})sender).DataContext [as]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}        |
|                                                                                                                                                                                                                      |
| [                        [ObjectModel]{style="COLOR: #2b91af"};]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                 |
|                                                                                                                                                                                                                      |
| [    args.PayLoad = obj;]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                        |
|                                                                                                                                                                                                                      |
| [    args.DragIcon = [new]{style="COLOR: blue"} [Image]{style="COLOR: #2b91af"}() { Source = obj.Icon };]{style="FONT-FAMILY: 'Courier New'"}                                                                        |
|                                                                                                                                                                                                                      |
| [   }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                           |
|                                                                                                                                                                                                                      |
| [}]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[]{style="FONT-FAMILY: Consolas; FONT-SIZE: 9.5pt"} 

[]{style="FONT-FAMILY: Consolas; FONT-SIZE: 9.5pt"} 

9.   In the Drop event handler, the dragged item is removed from the source **ListBox** control and added to the target **ListBox** control. This is shown in the following code snippet:

 

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **[\[C#\]]{style="FONT-FAMILY: 'Courier New'"}**                                                                                                                                                              |
|                                                                                                                                                                                                               |
| [// Drop event implementation]{style="FONT-FAMILY: 'Courier New'; COLOR: green"}                                                                                                                              |
|                                                                                                                                                                                                               |
| [void]{style="FONT-FAMILY: 'Courier New'; COLOR: blue"}[ DragAndDropManager_Drop([object]{style="COLOR: blue"} sender, [DragDropEventArgs]{style="COLOR: #2b91af"} args)]{style="FONT-FAMILY: 'Courier New'"} |
|                                                                                                                                                                                                               |
| [{]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                       |
|                                                                                                                                                                                                               |
| [ ObservableCollection]{style="FONT-FAMILY: 'Courier New'; COLOR: #2b91af"}[\<[ObjectModel]{style="COLOR: #2b91af"}\> sourceCollection = [null]{style="COLOR: blue"};]{style="FONT-FAMILY: 'Courier New'"}    |
|                                                                                                                                                                                                               |
| [ [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\> targetCollection = [null]{style="COLOR: blue"};]{style="FONT-FAMILY: 'Courier New'"}                                |
|                                                                                                                                                                                                               |
| [ [if]{style="COLOR: blue"} (args.PayLoad [is]{style="COLOR: blue"} [ObjectModel]{style="COLOR: #2b91af"})]{style="FONT-FAMILY: 'Courier New'"}                                                               |
|                                                                                                                                                                                                               |
| [  {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                     |
|                                                                                                                                                                                                               |
| [    source = args.DragSource [as]{style="COLOR: blue"} [ListBox]{style="COLOR: #2b91af"};]{style="FONT-FAMILY: 'Courier New'"}                                                                               |
|                                                                                                                                                                                                               |
| [    [if]{style="COLOR: blue"} (source != [null]{style="COLOR: blue"})]{style="FONT-FAMILY: 'Courier New'"}                                                                                                   |
|                                                                                                                                                                                                               |
| [     {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                  |
|                                                                                                                                                                                                               |
| [      sourceCollection = source.ItemsSource [as]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                                                                                                  |
|                                                                                                                                                                                                               |
| [                        [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\>;]{style="FONT-FAMILY: 'Courier New'"}                                                        |
|                                                                                                                                                                                                               |
| [     }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                  |
|                                                                                                                                                                                                               |
| [  [if]{style="COLOR: blue"} (args.DropTarget [is]{style="COLOR: blue"} [ListBox]{style="COLOR: #2b91af"})]{style="FONT-FAMILY: 'Courier New'"}                                                               |
|                                                                                                                                                                                                               |
| [   {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                    |
|                                                                                                                                                                                                               |
| [    destination = args.DropTarget [as]{style="COLOR: blue"} [ListBox]{style="COLOR: #2b91af"};]{style="FONT-FAMILY: 'Courier New'"}                                                                          |
|                                                                                                                                                                                                               |
| [    [if]{style="COLOR: blue"}(destination != [null]{style="COLOR: blue"})]{style="FONT-FAMILY: 'Courier New'"}                                                                                               |
|                                                                                                                                                                                                               |
| [      targetCollection = destination.ItemsSource [as]{style="COLOR: blue"} ]{style="FONT-FAMILY: 'Courier New'"}                                                                                             |
|                                                                                                                                                                                                               |
| [                         [ObservableCollection]{style="COLOR: #2b91af"}\<[ObjectModel]{style="COLOR: #2b91af"}\>;]{style="FONT-FAMILY: 'Courier New'"}                                                       |
|                                                                                                                                                                                                               |
| [    }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                   |
|                                                                                                                                                                                                               |
| [    [if]{style="COLOR: blue"} (args.PayLoad != [null]{style="COLOR: blue"} && targetCollection != [null]{style="COLOR: blue"} && ]{style="FONT-FAMILY: 'Courier New'"}                                       |
|                                                                                                                                                                                                               |
| [        sourceCollection != [null]{style="COLOR: blue"})]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                |
|                                                                                                                                                                                                               |
| [     {]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                  |
|                                                                                                                                                                                                               |
| [       sourceCollection.Remove(args.PayLoad [as]{style="COLOR: blue"} [ObjectModel]{style="COLOR: #2b91af"});]{style="FONT-FAMILY: 'Courier New'"}                                                           |
|                                                                                                                                                                                                               |
| [        targetCollection.Add(args.PayLoad [as]{style="COLOR: blue"} [ObjectModel]{style="COLOR: #2b91af"});]{style="FONT-FAMILY: 'Courier New'"}                                                             |
|                                                                                                                                                                                                               |
| [        }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                               |
|                                                                                                                                                                                                               |
| [     }]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                                                  |
|                                                                                                                                                                                                               |
| [ }]{style="FONT-FAMILY: 'Courier New'"}[]{style="FONT-FAMILY: 'Courier New'"}                                                                                                                                |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

 

10.  Now, run the sample and perform the drag and drop operation between the **ListBox** controls.

 

[]{#related-topics}
:::
